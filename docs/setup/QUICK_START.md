# üöÄ –ë—ã—Å—Ç—Ä—ã–π –°—Ç–∞—Ä—Ç - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ü–æ—Ç–µ—Ä–∏ –î–∞–Ω–Ω—ã—Ö

## üìã –ß—Ç–æ –°–¥–µ–ª–∞—Ç—å (5 –º–∏–Ω—É—Ç)

### 1Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Supabase (2 –º–∏–Ω)

–û—Ç–∫—Ä–æ–π—Ç–µ **Supabase Dashboard** ‚Üí **Table Editor**

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- –ï—Å—Ç—å –ª–∏ —Ç–∞–±–ª–∏—Ü–∞ `chat_sessions`?
- –ï—Å—Ç—å –ª–∏ –≤ –Ω–µ–π –∫–æ–ª–æ–Ω–∫–∞ `project_id`?

#### ‚úÖ –ï—Å–ª–∏ –î–ê (–∫–æ–ª–æ–Ω–∫–∞ `project_id` –µ—Å—Ç—å):
**–ù–∏—á–µ–≥–æ –¥–µ–ª–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ!** –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ —à–∞–≥—É 2.

#### ‚ùå –ï—Å–ª–∏ –ù–ï–¢ (–∫–æ–ª–æ–Ω–∫–∏ `project_id` –Ω–µ—Ç):

**–û—Ç–∫—Ä–æ–π—Ç–µ SQL Editor** –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```sql
-- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞:
-- supabase/migrations/20241111100000_add_projects_and_documents.sql

-- –ò–ª–∏ –≤—Ä—É—á–Ω—É—é –¥–æ–±–∞–≤—å—Ç–µ –∫–æ–ª–æ–Ω–∫—É:
ALTER TABLE public.chat_sessions
ADD COLUMN IF NOT EXISTS project_id uuid REFERENCES public.projects (id) ON DELETE SET NULL;

CREATE INDEX IF NOT EXISTS chat_sessions_project_id_idx ON public.chat_sessions (project_id);
```

#### üî¥ –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü `chat_sessions` –≤–æ–æ–±—â–µ –Ω–µ—Ç:

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –û–ë–ï –º–∏–≥—Ä–∞—Ü–∏–∏:
1. `supabase/migrations/20241110000000_create_chat_tables.sql`
2. `supabase/migrations/20241111100000_add_projects_and_documents.sql`

---

### 2Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env.local (30 —Å–µ–∫)

```bash
cat .env.local
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å:
```env
NEXT_PUBLIC_SUPABASE_URL=https://xxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJxxx...
OPENAI_API_KEY=sk-xxx
```

‚ùå –ï—Å–ª–∏ —Ñ–∞–π–ª–∞ –Ω–µ—Ç, —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏–∑ –ø—Ä–∏–º–µ—Ä–∞:
```bash
cp env.example .env.local
# –ò –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è
```

---

### 3Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏—Ç—å –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (1 –º–∏–Ω)

```bash
npm run dev
```

–û—Ç–∫—Ä–æ–π—Ç–µ: **http://localhost:3000**

---

### 4Ô∏è‚É£ –¢–µ—Å—Ç: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ó–∞–≥—Ä—É–∑–∫—É –∏–∑ –ë–î (2 –º–∏–Ω)

#### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —á–∞—Ç
1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç "Test"
2. –°–æ–∑–¥–∞–π—Ç–µ —á–∞—Ç
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ "Hello"

#### –®–∞–≥ 2: –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à
1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12)
2. Application ‚Üí Storage ‚Üí Clear Site Data
3. –ù–∞–∂–º–∏—Ç–µ **Clear**

#### –®–∞–≥ 3: –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
1. –ù–∞–∂–º–∏—Ç–µ F5
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç "Test"

**‚úÖ –£–°–ü–ï–• –µ—Å–ª–∏:**
- –ü—Ä–æ–µ–∫—Ç –ø–æ—è–≤–∏–ª—Å—è
- –ß–∞—Ç –∑–∞–≥—Ä—É–∑–∏–ª—Å—è
- –°–æ–æ–±—â–µ–Ω–∏–µ "Hello" –Ω–∞ –º–µ—Å—Ç–µ

**‚ùå –ü–†–û–ë–õ–ï–ú–ê –µ—Å–ª–∏:**
- –ü—Ä–æ–µ–∫—Ç –Ω–µ –ø–æ—è–≤–∏–ª—Å—è
- –ß–∞—Ç—ã –ø—É—Å—Ç—ã–µ

---

## üêõ –ë—ã—Å—Ç—Ä–æ–µ –†–µ—à–µ–Ω–∏–µ –ü—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: 500 Internal Server Error

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–≤–µ—Ä–Ω—ã–µ credentials Supabase

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env.local
cat .env.local

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ Supabase Dashboard:
# Settings ‚Üí API ‚Üí URL –∏ anon key
```

### –û—à–∏–±–∫–∞: –ß–∞—Ç—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã

**–†–µ—à–µ–Ω–∏–µ:**
1. Supabase Dashboard ‚Üí SQL Editor
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ:
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É
SELECT column_name 
FROM information_schema.columns 
WHERE table_name = 'chat_sessions' 
AND column_name = 'project_id';

-- –ï—Å–ª–∏ –ø—É—Å—Ç–æ, –¥–æ–±–∞–≤—å—Ç–µ –∫–æ–ª–æ–Ω–∫—É (—Å–º. —à–∞–≥ 1)
```

### –ö–æ–Ω—Å–æ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `TESTING_GUIDE.md` ‚Üí Troubleshooting

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–ï—Å–ª–∏ —Ç–µ—Å—Ç –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ:
```bash
# –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add .
git commit -m "fix: implement database-first data persistence"
git push
```

---

## üìö –ü–æ–¥—Ä–æ–±–Ω–∞—è –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **SUPABASE_SETUP.md** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ Supabase
- **TESTING_GUIDE.md** - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
- **DATA_PERSISTENCE_FIX.md** - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
- **IMPLEMENTATION_SUMMARY.md** - —á—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

---

**–í–æ–ø—Ä–æ—Å—ã?** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –∏ –ª–æ–≥–∏ Supabase.

